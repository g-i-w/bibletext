<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BibleCrossReference</title>
<style>
	body {
		font-family:sans-serif;
		font-size:1em;
		border:0;
		margin:0;
		padding:0;
	}
	div {
		margin:8px 0 0 0;
		min-height:20px;
		display:inline-block;
		max-width:500px;
		vertical-align:top;
		padding:0;
		border:0;
	}
	.controls-subdiv {
		visibility:hidden;		
	}
	.main-wrapper {
		visibility:hidden;		
		padding:8px;
	}
	.main-div {
		background-color:#fafafa;
		box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
	}
	.controls-subdiv {
		margin:0 8px 0 8px;
	}
	#controlsDiv {
		margin-top:0;
		padding:4px 0 4px 0;
	}
	input, select {
		padding: 4px 8px;
		margin: 4px 0 4px 0;
		display: inline-block;
		border: 1px solid #ccc;
		border-radius: 4px;
		box-sizing: border-box;
	}
	table {
		border-collapse:collapse;
		border:0;
		width:100%;
	}
	td {
		border:0;
		border-top:solid 1px lightgray;
		padding:8px;
	}
	td table td {
		border-top:0;
	}
	.top-td {
		border-top:0;
		border-bottom:solid 1px lightgray;
	}
	.highlighted {
		color:white;
		background-color:#004080;
		border:0;
	}
	a {
		color:#004080;
		text-decoration:none;
		/*padding:1px;*/
		border-radius:2px;
	}
	/*a:hover {
		color:#004080;
		background-color:lightgray;
	}*/
	a.highlighted {
		font-weight:bold;
	}
	td.highlighted, .highlighted td {
		color:black;
		border-top:0;
		margin-bottom:4px;
		background-color:#f0f0f0;
	}

</style>
</head>
<body>
	<center>
	
	<h1>Testing!</h1>
	<input id="test-input" value="">
	
	</center>


<script src="data:application/javascript;base64,Ly8gYnVpbGRpbmctYmxvY2sgZnVuY3Rpb25zCgpmdW5jdGlvbiBnZXRJZCAoIGlkICkgewoJcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBpZCApOwp9CgpmdW5jdGlvbiBnZXRWYWwgKCBpZCApIHsKCXJldHVybiBnZXRJZCggaWQgKS52YWx1ZTsKfQoKZnVuY3Rpb24gc2V0VmFsICggaWQsIHZhbCApIHsKCWNvbnNvbGUubG9nKCAnc2V0dGluZyAnK2lkKycgdG8gJyt2YWwgKTsKCXZhciBwcmV2ID0gZ2V0SWQoIGlkICkudmFsdWU7CglnZXRJZCggaWQgKS52YWx1ZSA9IHZhbDsKCXJldHVybiBwcmV2Owp9CgkKZnVuY3Rpb24gYmFzaWNDaGFyICggYyApIHsKCS8vIGNoZWNrIGZvciBzdWJzdGl0dXRlIGdyZWVrIGNoYXIKCWlmICgnzqzhvrPhvrThvrbhvrfhvbDhvbHhvIDhvIHhvILhvIPhvIThvIXhvIbhvoThvoUnLmluZGV4T2YoIGMgKSA+IC0xKSByZXR1cm4gJ86xJzsKCWlmICgn4byI4byJ4byL4byM4byN4byOJy5pbmRleE9mKCBjICkgPiAtMSkgcmV0dXJuICfOkSc7CglpZiAoJ86t4byQ4byR4byT4byU4byVJy5pbmRleE9mKCBjICkgPiAtMSkgcmV0dXJuICfOtSc7CglpZiAoJ+G8mOG8meG8m+G8nOG8nScuaW5kZXhPZiggYyApID4gLTEpIHJldHVybiAnzpUnOwoJaWYgKCfhvKjhvKnhvKrhvKvhvKzhvK3hvK4nLmluZGV4T2YoIGMgKSA+IC0xKSByZXR1cm4gJ86XJzsKCWlmICgnz4rOkOG9tuG9t86v4b+S4b+T4b+W4byw4byx4byz4by04by14by24by3Jy5pbmRleE9mKCBjICkgPiAtMSkgcmV0dXJuICfOuSc7CglpZiAoJ+G8uOG8ueG8vOG8vScuaW5kZXhPZiggYyApID4gLTEpIHJldHVybiAnzpknOwoJaWYgKCfPjOG9uOG9ueG9gOG9geG9guG9g+G9hOG9hScuaW5kZXhPZiggYyApID4gLTEpIHJldHVybiAnzr8nOwoJaWYgKCfhvYjhvYnhvYvhvYzhvY0nLmluZGV4T2YoIGMgKSA+IC0xKSByZXR1cm4gJ86fJzsKCWlmICgnzrDhv6bhv6LhvZDhvZHhvZLhvZPhvZThvZXhvZbhvZcnLmluZGV4T2YoIGMgKSA+IC0xKSByZXR1cm4gJ8+FJzsKCWlmICgn4b2Z4b2d4b2fJy5pbmRleE9mKCBjICkgPiAtMSkgcmV0dXJuICfOpSc7CglpZiAoJ8+O4b+z4b+04b+24b+34b6g4b6n4b2g4b2h4b2i4b2k4b2l4b2m4b2n4b284b29Jy5pbmRleE9mKCBjICkgPiAtMSkgcmV0dXJuICfPiSc7CglpZiAoJ+G9qOG9qeG9quG9rOG9reG9ruG9r+G+rycuaW5kZXhPZiggYyApID4gLTEpIHJldHVybiAnzqknOwoJaWYgKCfhvJDhvJHhvJPhvJThvJXhvbLhvbPOrScuaW5kZXhPZiggYyApID4gLTEpIHJldHVybiAnzrUnOwoJaWYgKCfPjc+L4b264b27Jy5pbmRleE9mKCBjICkgPiAtMSkgcmV0dXJuICfOvSc7CglpZiAoJ+G9tOG9teG/g+G/hOG/huG/h+G+kOG+keG+lOG+luG+l86u4byg4byh4byi4byj4byk4byl4bym4bynJy5pbmRleE9mKCBjICkgPiAtMSkgcmV0dXJuICfOtyc7CglpZiAoJ+G/pScuaW5kZXhPZiggYyApID4gLTEpIHJldHVybiAnz4EnOwoJaWYgKCfhv6wnLmluZGV4T2YoIGMgKSA+IC0xKSByZXR1cm4gJ86hJzsKCQoJLy8gY2hlY2sgZm9yIGJhc2ljIGdyZWVrIGNoYXIKCWlmICgnLeG+veKAmc6RzrHOks6yzpPOs86UzrTOlc61zpbOts6XzrfOmM64zpnOuc6azrrOm867zpzOvM6dzr3Ons6+zp/Ov86gz4DOoc+BzqPPg8+CzqTPhM6lz4XOps+GzqfPh86oz4jOqc+JJy5pbmRleE9mKCBjICkgPiAtMSkgcmV0dXJuIGM7CgkKCS8vIGNoZWNrIGZvciBiYXNpYyBoZWJyZXcgY2hhcgoJaWYgKCfXkNeR15LXk9eU15XXlteX15jXmdea15vXnNed157Xn9eg16HXotej16TXpdem16fXqNep16rXsNex17LXs9e01r7XgNeD14YnLmluZGV4T2YoIGMgKSA+IC0xKSByZXR1cm4gYzsKCQoJLy8gb3RoZXJ3aXNlIHJldHVybiBub3RoaW5nCgkvL2NvbnNvbGUubG9nKCAibm9uLXByaW50ZWQgY2hhcjogJyIrYysiJyIgKTsKCXJldHVybiAnJzsKfQoKZnVuY3Rpb24gYmFzaWNXb3JkICggd29yZCApIHsKCXZhciBiYXNpYyA9ICcnOwoJZm9yIChsZXQgaSA9IDA7IGkgPCB3b3JkLmxlbmd0aDsgaSsrKSB7CgkJYmFzaWMgKz0gYmFzaWNDaGFyKCB3b3JkW2ldICk7Cgl9CglyZXR1cm4gYmFzaWM7Cn0KCmZ1bmN0aW9uIHN1YnN0cmluZ1NldCAoIHdvcmQgKSB7Cgl2YXIgd29yZExlbmd0aCA9IHdvcmQubGVuZ3RoOwoJdmFyIHNldCA9IG5ldyBTZXQoKTsKCQoJZm9yIChsZXQgc2l6ZT13b3JkTGVuZ3RoLTE7IHNpemU+PTE7IHNpemUtLSkgewoJCWxldCBtYXhQb3MgPSB3b3JkTGVuZ3RoLXNpemU7IC8vIG1heCBzdGFydC1pbmRleCBvZiBzdWJzdHJpbmcKCQlmb3IgKGxldCBwb3M9MDsgcG9zPD1tYXhQb3M7IHBvcysrKSB7CgkJCWxldCBzdWJXb3JkID0gd29yZC5zdWJzdHJpbmcocG9zLCBwb3Mrc2l6ZSk7CgkJCXNldC5hZGQoIHN1YldvcmQgKTsKCQl9Cgl9CglyZXR1cm4gc2V0Owp9CgpmdW5jdGlvbiB3b3JkSGFzaCAoIGtleSApIHsKCWxldCBsZW4gPSBrZXkubGVuZ3RoOwoJaWYgKGxlbiA8PSAyKSByZXR1cm4ga2V5OwoJcmV0dXJuIGtleS5zdWJzdHJpbmcoIDAsIDEgKStrZXkuc3Vic3RyaW5nKCBsZW4tMSwgbGVuICk7IC8vIGZpcnN0K2xhc3QKfQoKZnVuY3Rpb24gbGFzdCAoIGFycmF5ICkgewoJcmV0dXJuIGFycmF5W2FycmF5Lmxlbmd0aC0xXTsKfQoKZnVuY3Rpb24gc29tZXRoaW5nICggYW55dGhpbmcgKSB7CglpZiAoYW55dGhpbmchPT11bmRlZmluZWQgJiYgYW55dGhpbmchPW51bGwgJiYgYW55dGhpbmchPT0nJykgcmV0dXJuIHRydWU7CgllbHNlIHJldHVybiBmYWxzZTsKfQoKZnVuY3Rpb24gb2JqZWN0UGF0aCAoIG9iaiwgcGF0aEFycmF5ICkgewoJY29uc29sZS5sb2coIHBhdGhBcnJheSApOwoJaWYgKCFzb21ldGhpbmcob2JqKSkgcmV0dXJuIG51bGw7Cglmb3IgKGNvbnN0IGtleSBvZiBPYmplY3QudmFsdWVzKHBhdGhBcnJheSkpIHsKCQlpZiAoIXNvbWV0aGluZyhvYmpba2V5XSkpIHsKCQkJLy9jb25zb2xlLmxvZyhvYmopOwoJCQkvL2NvbnNvbGUubG9nKCAiY291bGRuJ3QgZmluZCBrZXk6ICIra2V5ICk7CgkJCXJldHVybiBudWxsOwoJCX0KCQlvYmogPSBvYmpba2V5XTsKCX0KCXJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIGluQXJyYXkgKCBhcnJPYmosIGFyclZhbCApIHsKCWZvciAobGV0IHZhbCBvZiBPYmplY3QudmFsdWVzKGFyck9iaikpIHsKCQlpZiAoYXJyVmFsPT12YWwpIHJldHVybiB0cnVlOwoJfQoJcmV0dXJuIGZhbHNlOwp9CgoKCi8vIHN0cnVjdHVyYWwgZnVuY3Rpb25zCgpmdW5jdGlvbiB2ZXJzZVRleHQgKCBiaWJsZU9iaiwgYm9vaywgY2hhcCwgdmVyc2UgKSB7CgkvL2NvbnNvbGUubG9nKCAndmVyc2VUZXh0OiAnK2Jvb2srJywnK2NoYXArJywnK3ZlcnNlICk7CglpZiAoc29tZXRoaW5nKCBiaWJsZU9iaiApICYmIHNvbWV0aGluZyggYmlibGVPYmpbYm9va10gKSAmJiBzb21ldGhpbmcoIGJpYmxlT2JqW2Jvb2tdW2NoYXBdICkpIHsKCQlyZXR1cm4gYmlibGVPYmpbYm9va11bY2hhcF1bdmVyc2VdOwoJfSBlbHNlIHsKCQkvL3JldHVybiBgW05PVCBGT1VORDogJHtib29rfSAke2NoYXB9OiR7dmVyc2V9XWA7CgkJcmV0dXJuICcnOwoJfQp9CgpmdW5jdGlvbiBnZXRCb29rcyAoIGJpYmxlT2JqICkgewoJaWYgKHNvbWV0aGluZyggYmlibGVPYmogKSkgcmV0dXJuIE9iamVjdC5rZXlzKCBiaWJsZU9iaiApOwoJZWxzZSByZXR1cm4gW107Cn0KCmZ1bmN0aW9uIGdldENoYXBzICggYmlibGVPYmosIGJvb2sgKSB7CglpZiAoc29tZXRoaW5nKCBiaWJsZU9iaiApICYmIHNvbWV0aGluZyggYmlibGVPYmpbYm9va10gKSkgcmV0dXJuIE9iamVjdC5rZXlzKCBiaWJsZU9ialtib29rXSApOwoJZWxzZSByZXR1cm4gW107Cn0KCmZ1bmN0aW9uIGdldFZlcnNlcyAoIGJpYmxlT2JqLCBib29rLCBjaGFwICkgewoJaWYgKHNvbWV0aGluZyggYmlibGVPYmogKSAmJiBzb21ldGhpbmcoIGJpYmxlT2JqW2Jvb2tdICkgJiYgc29tZXRoaW5nKCBiaWJsZU9ialtib29rXVtjaGFwXSApKSByZXR1cm4gT2JqZWN0LmtleXMoIGJpYmxlT2JqW2Jvb2tdW2NoYXBdICk7CgllbHNlIHJldHVybiBbXTsKfQoKZnVuY3Rpb24gdmVyc2VEYXRhICggYmlibGVPYmosIGJvb2ssIGNoYXAsIHZlcnNlICkgewoJdmFyIHByZXZCb29rID0gYm9vazsKCXZhciBuZXh0Qm9vayA9IGJvb2s7Cgl2YXIgYm9va3NBcnIgPSBnZXRCb29rcyhiaWJsZU9iaik7Cglmb3IgKGxldCBpPTA7IGk8Ym9va3NBcnIubGVuZ3RoOyBpKyspIHsKCQlpZiAoYm9vaz09Ym9va3NBcnJbaV0pIHsKCQkJaWYgKGk+MCkgcHJldkJvb2s9Ym9va3NBcnJbaS0xXTsKCQkJaWYgKGk8Ym9va3NBcnIubGVuZ3RoLTEpIG5leHRCb29rPWJvb2tzQXJyW2krMV07CgkJCWJyZWFrOwoJCX0KCX0KCS8vY29uc29sZS5sb2coICdwcmV2Qm9vazogJytwcmV2Qm9vaysnLCBib29rOiAnK2Jvb2srJywgbmV4dEJvb2s6ICcrbmV4dEJvb2sgKTsKCXZhciBjaGFwTnVtID0gTnVtYmVyKGNoYXApOwoJdmFyIGxhc3RDaGFwTnVtID0gTnVtYmVyKGxhc3QoZ2V0Q2hhcHMoYmlibGVPYmosYm9vaykpKTsKCXZhciB2ZXJzZU51bSA9IE51bWJlcih2ZXJzZSk7Cgl2YXIgbGFzdFZlcnNlTnVtID0gTnVtYmVyKGxhc3QoZ2V0VmVyc2VzKGJpYmxlT2JqLGJvb2ssY2hhcCkpKTsKCS8vY29uc29sZS5sb2coICdjaGFwTnVtOiAnK2NoYXBOdW0rJywgbGFzdENoYXBOdW06ICcrbGFzdENoYXBOdW0rJywgdmVyc2VOdW06ICcrdmVyc2VOdW0rJywgbGFzdFZlcnNlTnVtOiAnK2xhc3RWZXJzZU51bSApOwoJCgl2YXIgZGF0YSA9IHsKCQlwcmV2VmVyc2U6IHsgYm9vazpudWxsLCBjaGFwOm51bGwsIHZlcnNlOm51bGwgfSwKCQluZXh0VmVyc2U6IHsgYm9vazpudWxsLCBjaGFwOm51bGwsIHZlcnNlOm51bGwgfQoJfTsKCQoJLy8gbmV4dCB2ZXJzZQoJaWYgKHZlcnNlTnVtKzEgPiBsYXN0VmVyc2VOdW0pIHsKCQlpZiAoY2hhcE51bSsxID4gbGFzdENoYXBOdW0pIHsKCQkJaWYgKG5leHRCb29rPT1ib29rKSB7CgkJCQkvLyBkbyBub3RoaW5nCgkJCQlkYXRhLm5leHRWZXJzZS5ib29rID0gJyc7CgkJCQlkYXRhLm5leHRWZXJzZS5jaGFwID0gJyc7CgkJCQlkYXRhLm5leHRWZXJzZS52ZXJzZSA9ICcnOwoJCQkJY29uc29sZS5sb2coICJORVhUOiBkbyBub3RoaW5nOiAiK2RhdGEubmV4dFZlcnNlLmJvb2srJywnK2RhdGEubmV4dFZlcnNlLmNoYXArJywnK2RhdGEubmV4dFZlcnNlLnZlcnNlICk7CgkJCX0gZWxzZSB7CgkJCQkvLyBvdGhlcndpc2UgbmV4dCBib29rCgkJCQlkYXRhLm5leHRWZXJzZS5ib29rID0gbmV4dEJvb2s7CgkJCQlkYXRhLm5leHRWZXJzZS5jaGFwID0gJzEnOwoJCQkJZGF0YS5uZXh0VmVyc2UudmVyc2UgPSAnMSc7CgkJCQljb25zb2xlLmxvZyggIk5FWFQ6IG5leHQgYm9vazogIitkYXRhLm5leHRWZXJzZS5ib29rKycsJytkYXRhLm5leHRWZXJzZS5jaGFwKycsJytkYXRhLm5leHRWZXJzZS52ZXJzZSApOwoJCQl9CgkJfSBlbHNlIHsKCQkJLy8gb3RoZXJ3aXNlIG5leHQgY2hhcHRlcgoJCQlkYXRhLm5leHRWZXJzZS5ib29rID0gYm9vazsKCQkJZGF0YS5uZXh0VmVyc2UuY2hhcCA9IChjaGFwTnVtKzEpLnRvU3RyaW5nKCk7CgkJCWRhdGEubmV4dFZlcnNlLnZlcnNlID0gJzEnOwoJCQkvL2NvbnNvbGUubG9nKCAiTkVYVDogbmV4dCBjaGFwOiAiK2RhdGEubmV4dFZlcnNlLmJvb2srJywnK2RhdGEubmV4dFZlcnNlLmNoYXArJywnK2RhdGEubmV4dFZlcnNlLnZlcnNlICk7CgkJfQoJfSBlbHNlIHsKCQkvLyBvdGhlcndpc2UgbmV4dCB2ZXJzZQoJCWRhdGEubmV4dFZlcnNlLmJvb2sgPSBib29rOwoJCWRhdGEubmV4dFZlcnNlLmNoYXAgPSBjaGFwOwoJCWRhdGEubmV4dFZlcnNlLnZlcnNlID0gKHZlcnNlTnVtKzEpLnRvU3RyaW5nKCk7CgkJLy9jb25zb2xlLmxvZyggIk5FWFQ6IG5leHQgdmVyc2U6ICIrZGF0YS5uZXh0VmVyc2UuYm9vaysnLCcrZGF0YS5uZXh0VmVyc2UuY2hhcCsnLCcrZGF0YS5uZXh0VmVyc2UudmVyc2UgKTsKCX0KCQoJLy8gcHJldiB2ZXJzZQoJaWYgKHZlcnNlTnVtLTEgPCAxKSB7CgkJaWYgKGNoYXBOdW0tMSA8IDEpIHsKCQkJaWYgKHByZXZCb29rPT1ib29rKSB7CgkJCQkvLyBkbyBub3RoaW5nCgkJCQlkYXRhLnByZXZWZXJzZS5ib29rID0gJyc7CgkJCQlkYXRhLnByZXZWZXJzZS5jaGFwID0gJyc7CgkJCQlkYXRhLnByZXZWZXJzZS52ZXJzZSA9ICcnOwoJCQkJLy9jb25zb2xlLmxvZyggIlBSRVY6IGRvIG5vdGhpbmc6ICIrZGF0YS5wcmV2VmVyc2UuYm9vaysnLCcrZGF0YS5wcmV2VmVyc2UuY2hhcCsnLCcrZGF0YS5wcmV2VmVyc2UudmVyc2UgKTsKCQkJfSBlbHNlIHsKCQkJCS8vIG90aGVyd2lzZSBwcmV2IGJvb2sKCQkJCWxldCBwcmV2Q2hhcCA9IGxhc3QoZ2V0Q2hhcHMoYmlibGVPYmoscHJldkJvb2spKTsKCQkJCWxldCBwcmV2VmVyc2UgPSBsYXN0KGdldFZlcnNlcyhiaWJsZU9iaixwcmV2Qm9vayxwcmV2Q2hhcCkpOwoJCQkJZGF0YS5wcmV2VmVyc2UuYm9vayA9IHByZXZCb29rOwoJCQkJZGF0YS5wcmV2VmVyc2UuY2hhcCA9IHByZXZDaGFwOwoJCQkJZGF0YS5wcmV2VmVyc2UudmVyc2UgPSBwcmV2VmVyc2U7CgkJCQkvL2NvbnNvbGUubG9nKCAiUFJFVjogcHJldiBib29rOiAiK2RhdGEucHJldlZlcnNlLmJvb2srJywnK2RhdGEucHJldlZlcnNlLmNoYXArJywnK2RhdGEucHJldlZlcnNlLnZlcnNlICk7CgkJCX0KCQl9IGVsc2UgewoJCQkvLyBvdGhlcndpc2UgcHJldiBjaGFwdGVyCgkJCWxldCBwcmV2Q2hhcCA9IChjaGFwTnVtLTEpLnRvU3RyaW5nKCk7CgkJCWxldCBwcmV2VmVyc2UgPSBsYXN0KGdldFZlcnNlcyhiaWJsZU9iaixib29rLHByZXZDaGFwKSk7CgkJCWRhdGEucHJldlZlcnNlLmJvb2sgPSBib29rOwoJCQlkYXRhLnByZXZWZXJzZS5jaGFwID0gcHJldkNoYXA7CgkJCWRhdGEucHJldlZlcnNlLnZlcnNlID0gcHJldlZlcnNlOwoJCQkvL2NvbnNvbGUubG9nKCAiUFJFVjogcHJldiBjaGFwOiAiK2RhdGEucHJldlZlcnNlLmJvb2srJywnK2RhdGEucHJldlZlcnNlLmNoYXArJywnK2RhdGEucHJldlZlcnNlLnZlcnNlICk7CgkJfQoJfSBlbHNlIHsKCQkvLyBvdGhlcndpc2UgcHJldiB2ZXJzZQoJCWxldCBwcmV2VmVyc2UgPSAodmVyc2VOdW0tMSkudG9TdHJpbmcoKTsKCQlkYXRhLnByZXZWZXJzZS5ib29rID0gYm9vazsKCQlkYXRhLnByZXZWZXJzZS5jaGFwID0gY2hhcDsKCQlkYXRhLnByZXZWZXJzZS52ZXJzZSA9IHByZXZWZXJzZTsKCQkvL2NvbnNvbGUubG9nKCAiUFJFVjogcHJldiBjaGFwOiAiK2RhdGEucHJldlZlcnNlLmJvb2srJywnK2RhdGEucHJldlZlcnNlLmNoYXArJywnK2RhdGEucHJldlZlcnNlLnZlcnNlICk7Cgl9CgkKCXJldHVybiBkYXRhOwp9CgpmdW5jdGlvbiBleGFjdFdvcmQgKCB0ZXh0LCBiYXNpYyApIHsKCS8vY29uc29sZS5sb2coIHRleHQgKTsKCXZhciBodG1sID0gJyc7CglpZiAoc29tZXRoaW5nKCB0ZXh0ICkpIHsKCQlmb3IgKGxldCB3b3JkIG9mIHRleHQuc3BsaXQoL1xzKy8pKSB7CgkJCWlmIChiYXNpY1dvcmQoIHdvcmQgKT09YmFzaWMpIGh0bWwgKz0gIiA8YSBocmVmPVwiI3dvcmRWaWV3XCIgb25jbGljaz1cImNoYW5nZVdvcmQoJyIrd29yZCsiJylcIj4iK3dvcmQrIjwvYT4iOwoJCX0KCX0KCXJldHVybiBodG1sOwp9CgpmdW5jdGlvbiBzdHJvbmdzSW5mbyAoIHdvcmQgKSB7Cgl2YXIgYmFzaWNUb0NvZGUgPSBpbnRlcmxpbmVhci5zdHJvbmdzLmJhc2ljVG9Db2RlOwoJdmFyIGNvZGVUb1JlcGxhY2VtZW50ID0gaW50ZXJsaW5lYXIuc3Ryb25ncy5jb2RlVG9SZXBsYWNlbWVudDsKCXZhciBiYXNpYyA9IGJhc2ljV29yZCggd29yZCApOwoJdmFyIGhhc2ggPSB3b3JkSGFzaCggYmFzaWMgKTsKCXZhciBodG1sID0gJzx0YWJsZT4nOwoJaWYgKHNvbWV0aGluZyggYmFzaWNUb0NvZGVbaGFzaF0gKSAmJiBzb21ldGhpbmcoIGJhc2ljVG9Db2RlW2hhc2hdW2Jhc2ljXSApKSB7CgkJZm9yIChjb25zdCBbY29kZSwgY29kZU9ial0gb2YgT2JqZWN0LmVudHJpZXMoYmFzaWNUb0NvZGVbaGFzaF1bYmFzaWNdKSkgewoJCQlsZXQgY29kZUhhc2ggPSBjb2RlLnN1YnN0cmluZygwLDMpOwoJCQlpZiAoc29tZXRoaW5nKCBjb2RlVG9SZXBsYWNlbWVudFtjb2RlSGFzaF0gKSAmJiBzb21ldGhpbmcoIGNvZGVUb1JlcGxhY2VtZW50W2NvZGVIYXNoXVtjb2RlXSApKSB7CgkJCQlmb3IgKGNvbnN0IFtyZXAsIHJlcE9ial0gb2YgT2JqZWN0LmVudHJpZXMoY29kZVRvUmVwbGFjZW1lbnRbY29kZUhhc2hdW2NvZGVdKSkgewoJCQkJCWh0bWwgKz0gIjx0cj48dGQgc3R5bGU9XCJmb250LXNpemU6MC43ZW07Y29sb3I6Z3JheTtcIj4iK2NvZGUrIjwvdGQ+PHRkIHN0eWxlPVwiZm9udC1zaXplOjAuOGVtO1wiPiIrcmVwKyI8L3RkPjwvdHI+IjsKCQkJCX0KCQkJfQoJCX0KCX0KCWh0bWwgKz0gJzwvdGFibGU+JzsKCXJldHVybiBodG1sOwp9CgpmdW5jdGlvbiBzdHJvbmdzTGlzdCAoIHdvcmQgKSB7Cgl2YXIgYmFzaWNUb0NvZGUgPSBpbnRlcmxpbmVhci5zdHJvbmdzLmJhc2ljVG9Db2RlOwoJdmFyIGNvZGVUb1JlcGxhY2VtZW50ID0gaW50ZXJsaW5lYXIuc3Ryb25ncy5jb2RlVG9SZXBsYWNlbWVudDsKCXZhciBiYXNpYyA9IGJhc2ljV29yZCggd29yZCApOwoJdmFyIGhhc2ggPSB3b3JkSGFzaCggYmFzaWMgKTsKCXZhciBsaXN0ID0gW107CglpZiAoc29tZXRoaW5nKCBiYXNpY1RvQ29kZVtoYXNoXSApICYmIHNvbWV0aGluZyggYmFzaWNUb0NvZGVbaGFzaF1bYmFzaWNdICkpIHsKCQlmb3IgKGNvbnN0IFtjb2RlLCBjb2RlT2JqXSBvZiBPYmplY3QuZW50cmllcyhiYXNpY1RvQ29kZVtoYXNoXVtiYXNpY10pKSB7CgkJCWxldCBjb2RlSGFzaCA9IGNvZGUuc3Vic3RyaW5nKDAsMyk7CgkJCWlmIChzb21ldGhpbmcoIGNvZGVUb1JlcGxhY2VtZW50W2NvZGVIYXNoXSApICYmIHNvbWV0aGluZyggY29kZVRvUmVwbGFjZW1lbnRbY29kZUhhc2hdW2NvZGVdICkpIHsKCQkJCWZvciAoY29uc3QgW3JlcCwgcmVwT2JqXSBvZiBPYmplY3QuZW50cmllcyhjb2RlVG9SZXBsYWNlbWVudFtjb2RlSGFzaF1bY29kZV0pKSB7CgkJCQkJbGlzdC5wdXNoLmFwcGx5KCBsaXN0LCBhbHBoYVRleHQocmVwKSApOwoJCQkJfQoJCQl9CgkJfQoJfQoJcmV0dXJuIGxpc3Q7Cn0KCmZ1bmN0aW9uIHN0cm9uZ3NJbmZvVmVyc2UgKCB3b3JkLCBib29rLCBjaGFwLCB2ZXJzZSApIHsKCXZhciBiYXNpY1RvQ29kZSA9IGludGVybGluZWFyLnN0cm9uZ3MuYmFzaWNUb0NvZGU7Cgl2YXIgY29kZVRvUmVwbGFjZW1lbnQgPSBpbnRlcmxpbmVhci5zdHJvbmdzLmNvZGVUb1JlcGxhY2VtZW50OwoJdmFyIGJhc2ljID0gYmFzaWNXb3JkKCB3b3JkICk7Cgl2YXIgaGFzaCA9IHdvcmRIYXNoKCBiYXNpYyApOwoJdmFyIGh0bWwgPSAnPHRhYmxlPic7CglpZiAoc29tZXRoaW5nKCBiYXNpY1RvQ29kZVtoYXNoXSApICYmIHNvbWV0aGluZyggYmFzaWNUb0NvZGVbaGFzaF1bYmFzaWNdICkpIHsKCQlmb3IgKGNvbnN0IFtjb2RlLCBjb2RlT2JqXSBvZiBPYmplY3QuZW50cmllcyhiYXNpY1RvQ29kZVtoYXNoXVtiYXNpY10pKSB7CgkJCWxldCBjb2RlSGFzaCA9IGNvZGUuc3Vic3RyaW5nKDAsMyk7CgkJCWlmIChzb21ldGhpbmcoIGNvZGVUb1JlcGxhY2VtZW50W2NvZGVIYXNoXSApICYmIHNvbWV0aGluZyggY29kZVRvUmVwbGFjZW1lbnRbY29kZUhhc2hdW2NvZGVdICkpIHsKCQkJCWZvciAoY29uc3QgW3JlcCwgcmVwT2JqXSBvZiBPYmplY3QuZW50cmllcyhjb2RlVG9SZXBsYWNlbWVudFtjb2RlSGFzaF1bY29kZV0pKSB7CgkJCQkJLy9jb25zb2xlLmxvZyggInRlc3Rpbmcgc3Ryb25ncyBwYXRoOiAiK3dvcmQgKTsKCQkJCQl2YXIgb2JqID0gb2JqZWN0UGF0aCggaW50ZXJsaW5lYXIuZGF0YSwgWyBoYXNoLCBiYXNpYywgY29kZSwgYm9vaywgY2hhcCBdICk7CgkJCQkJaWYgKHNvbWV0aGluZyhvYmopKSB7CgkJCQkJCS8vY29uc29sZS5sb2cob2JqKTsKCQkJCQkJLy9jb25zb2xlLmxvZyggdmVyc2UgKTsKCQkJCQkJaWYgKGluQXJyYXkob2JqLCB2ZXJzZSkpCgkJCQkJCQlodG1sICs9ICI8dHI+PHRkIHN0eWxlPVwiZm9udC1zaXplOjAuN2VtO2NvbG9yOmdyYXk7XCI+Iitjb2RlKyI8L3RkPjx0ZCBzdHlsZT1cImZvbnQtc2l6ZTowLjhlbTtcIj4iK3JlcCsiPC90ZD48L3RyPiI7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfQoJaHRtbCArPSAnPC90YWJsZT4nOwoJcmV0dXJuIGh0bWw7Cn0KCmZ1bmN0aW9uIGlzVmVyc2UgKCBib29rLCBjaGFwLCB2ZXJzZSApIHsKCS8vcmV0dXJuICggbGFuZ1RvQ29kZShnZXRWYWwoImJvb2siKSk9PWxhbmdUb0NvZGUoYm9vaykgJiYgZ2V0VmFsKCJjaGFwIik9PWNoYXAgJiYgZ2V0VmFsKCJ2ZXJzZSIpPT12ZXJzZSApOwoJcmV0dXJuICggc3RhdGUuYm9vaz09Ym9vayAmJiBzdGF0ZS5jaGFwPT1jaGFwICYmIHN0YXRlLnZlcnNlPT12ZXJzZSApOwp9CgpmdW5jdGlvbiBpc1dvcmQgKCB3b3JkICkgewoJcmV0dXJuICggc3RhdGUud29yZCA9PSBiYXNpY1dvcmQod29yZCkgKTsKfQoKZnVuY3Rpb24gbmJOdW1iZXIgKCBib29rICkgewoJaWYgKGJvb2suaW5kZXhPZignICcpPT0xKSByZXR1cm4gYm9vay5zdWJzdHJpbmcoMCwxKSsnJm5ic3A7Jytib29rLnN1YnN0cmluZygyKTsgLy8gaWYgc2Vjb25kIGNoYXIgaXMgc3BhY2UsIHJlcGxhY2Ugd2l0aCAnJm5ic3A7JwoJZWxzZSByZXR1cm4gYm9vazsKfQoKZnVuY3Rpb24gdmVyc2VMaW5rICggYm9vaywgY2hhcCwgdmVyc2UsIGxpbmsgKSB7CglpZiAoIXNvbWV0aGluZyggbGluayApKSBsaW5rID0gbmJOdW1iZXIoY29kZVRvTGFuZyhib29rKSkrJyZuYnNwOycrY2hhcCsnOicrdmVyc2U7CglpZiAoaXNWZXJzZSggYm9vaywgY2hhcCwgdmVyc2UgKSkKCQlyZXR1cm4gYDxhIGhyZWY9IiN2ZXJzZVZpZXciIG9uY2xpY2s9InN0YXRlLnZpZXc9J3ZlcnNlVmlldyc7Y2hhbmdlVmVyc2UoJyR7Ym9va30nLCcke2NoYXB9JywnJHt2ZXJzZX0nKTsiIGNsYXNzPSJoaWdobGlnaHRlZCI+JHtsaW5rfTwvYT5gOwoJZWxzZQoJCXJldHVybiBgPGEgaHJlZj0iI3ZlcnNlVmlldyIgb25jbGljaz0ic3RhdGUudmlldz0ndmVyc2VWaWV3JztjaGFuZ2VWZXJzZSgnJHtib29rfScsJyR7Y2hhcH0nLCcke3ZlcnNlfScpOyI+JHtsaW5rfTwvYT5gOwp9CgpmdW5jdGlvbiB3b3JkTGluayAoIHdvcmQsIGxpbmsgKSB7CglpZiAoIXNvbWV0aGluZyggbGluayApKSBsaW5rID0gd29yZDsKCWlmIChpc1dvcmQoIHdvcmQgKSkKCQlyZXR1cm4gYDxhIGhyZWY9IiN3b3JkVmlldyIgb25jbGljaz0ic3RhdGUudmlldz0nd29yZFZpZXcnO2NoYW5nZVdvcmQoJyR7d29yZH0nKTsiIGNsYXNzPSJoaWdobGlnaHRlZCI+JHtsaW5rfTwvYT5gOwoJZWxzZQoJCXJldHVybiBgPGEgaHJlZj0iI3dvcmRWaWV3IiBvbmNsaWNrPSJzdGF0ZS52aWV3PSd3b3JkVmlldyc7Y2hhbmdlV29yZCgnJHt3b3JkfScpOyI+JHtsaW5rfTwvYT5gOwp9CgpmdW5jdGlvbiBncmF5ZWRPdXQgKCBpY29uICkgewoJcmV0dXJuICc8c3BhbiBzdHlsZT0iY29sb3I6bGlnaHRncmF5OyI+JytpY29uKyc8L3NwYW4+JzsKfQoKZnVuY3Rpb24gdmVyc2VGd2RCYWNrICgpIHsKCXZhciBodG1sID0gJyc7Cgl2YXIgaGlzdG9yeSA9IE9iamVjdC52YWx1ZXModmVyc2VIaXN0b3J5KTsKCWZvciAobGV0IGk9MDsgaTxoaXN0b3J5Lmxlbmd0aDsgaSsrKSB7CgkJaWYoIGlzVmVyc2UoIGhpc3RvcnlbaV0uYm9vaywgaGlzdG9yeVtpXS5jaGFwLCBoaXN0b3J5W2ldLnZlcnNlICkgKSB7CgkJCS8vIGJhY2sgbGluawoJCQlpZiAoaSA+IDApIGh0bWwgKz0gdmVyc2VMaW5rKCBoaXN0b3J5W2ktMV0uYm9vaywgaGlzdG9yeVtpLTFdLmNoYXAsIGhpc3RvcnlbaS0xXS52ZXJzZSwgbGVmdEFycm93ICk7CgkJCWVsc2UgaHRtbCArPSBncmF5ZWRPdXQobGVmdEFycm93KTsKCQkJaHRtbCArPSAnJm5ic3A7JzsKCQkJLy8gZndkIGxpbmsKCQkJaWYgKGkgPCBoaXN0b3J5Lmxlbmd0aC0xKSBodG1sICs9IHZlcnNlTGluayggaGlzdG9yeVtpKzFdLmJvb2ssIGhpc3RvcnlbaSsxXS5jaGFwLCBoaXN0b3J5W2krMV0udmVyc2UsIHJpZ2h0QXJyb3cgKTsKCQkJZWxzZSBodG1sICs9IGdyYXllZE91dChyaWdodEFycm93KTsKCQl9Cgl9CglyZXR1cm4gaHRtbDsKfQoJCmZ1bmN0aW9uIHdvcmRGd2RCYWNrICgpIHsKCXZhciBodG1sID0gJyc7Cgl2YXIgaGlzdG9yeSA9IE9iamVjdC5rZXlzKHdvcmRIaXN0b3J5KTsKCWZvciAobGV0IGk9MDsgaTxoaXN0b3J5Lmxlbmd0aDsgaSsrKSB7CgkJaWYoIGlzV29yZCggaGlzdG9yeVtpXSApICkgewoJCQkvLyBiYWNrIGxpbmsKCQkJaWYgKGkgPiAwKSBodG1sICs9IHdvcmRMaW5rKCBoaXN0b3J5W2ktMV0sIGxlZnRBcnJvdyApOwoJCQllbHNlIGh0bWwgKz0gZ3JheWVkT3V0KGxlZnRBcnJvdyk7CgkJCWh0bWwgKz0gJyZuYnNwOyc7CgkJCS8vIGZ3ZCBsaW5rCgkJCWlmIChpIDwgaGlzdG9yeS5sZW5ndGgtMSkgaHRtbCArPSB3b3JkTGluayggaGlzdG9yeVtpKzFdLCByaWdodEFycm93ICk7CgkJCWVsc2UgaHRtbCArPSBncmF5ZWRPdXQocmlnaHRBcnJvdyk7CgkJfQoJfQoJcmV0dXJuIGh0bWw7Cn0KCmZ1bmN0aW9uIHZlcnNlQW5hbHlzaXMgKCB2ZXJzZUFycmF5LCBib29rLCBjaGFwLCB2ZXJzZSApIHsKCXZhciBodG1sID0gJzx0YWJsZT4nOwoJZm9yIChsZXQgd29yZCBvZiB2ZXJzZUFycmF5KSB7CgkJaWYgKHdvcmQuaW5kZXhPZign1r4nKT4tMSkgewoJCQlsZXQgZGVsaW0gPSAnYm9yZGVyLXJpZ2h0OnNvbGlkIDFweCBsaWdodGdyYXk7JzsKCQkJZm9yIChsZXQgc3ViV29yZCBvZiBPYmplY3QudmFsdWVzKHdvcmQuc3BsaXQoL9a+LykpKSB7CgkJCQkvL2NvbnNvbGUubG9nKCBzdWJXb3JkICk7CgkJCQlodG1sICs9ICc8dHI+PHRkIHN0eWxlPSInK2RlbGltKyciPicrd29yZExpbmsoIHN1YldvcmQgKSsnPC90ZD48dGQ+JytvdmVybGFwKCB2ZXJzZVRleHQoIGludGVybGluZWFyLnRyYW5zbGF0aW9uc1tsYW5ndWFnZVN0cm9uZ3NdLCBib29rLCBjaGFwLCB2ZXJzZSApLCBzdHJvbmdzTGlzdCggc3ViV29yZCApICkrJzwvdGQ+PHRkPicrZ2VtYXRyaWEoIHN1YldvcmQgKVswXSsnPC90ZD48L3RyPic7CgkJCQlkZWxpbSA9ICdib3JkZXItdG9wOjA7Ym9yZGVyLXJpZ2h0OnNvbGlkIDFweCBsaWdodGdyYXk7JzsKCQkJfQoJCX0gZWxzZSB7CgkJCWh0bWwgKz0gJzx0cj48dGQ+Jyt3b3JkTGluayggd29yZCApKyc8L3RkPjx0ZD4nK292ZXJsYXAoIHZlcnNlVGV4dCggaW50ZXJsaW5lYXIudHJhbnNsYXRpb25zW2xhbmd1YWdlU3Ryb25nc10sIGJvb2ssIGNoYXAsIHZlcnNlICksIHN0cm9uZ3NMaXN0KCB3b3JkICkgKSsnPC90ZD48dGQ+JytnZW1hdHJpYSggd29yZCApWzBdKyc8L3RkPjwvdHI+JzsKCQl9Cgl9CglodG1sICs9ICc8L3RhYmxlPic7CglyZXR1cm4gaHRtbDsKfQoJCmZ1bmN0aW9uIHdvcmRJbmZvICggd29yZCApIHsKCS8vY29uc29sZS5sb2coICd3b3JkSW5mbzogJyt3b3JkICk7CgkKCXZhciBiYXNpYyA9IGJhc2ljV29yZCggd29yZCApOwoJdmFyIGhhc2ggPSB3b3JkSGFzaCggYmFzaWMgKTsKCQoJLy8gaGlzdG9yeQoJdmFyIGh0bWwgPSAnPHRhYmxlPjx0cj48dGQgY2xhc3M9InRvcC10ZCI+Jyt3b3JkRndkQmFjaygpKyc8L3RkPjx0ZCBjbGFzcz0idG9wLXRkIj4nOwoJdmFyIGRlbGltID0gJyc7Cglmb3IgKGNvbnN0IFtrZXksIG51bGxPYmpdIG9mIE9iamVjdC5lbnRyaWVzKHdvcmRIaXN0b3J5KSkgewoJCWh0bWwgKz0gZGVsaW0rd29yZExpbmsoIGtleSApOwoJCWRlbGltID0gJyZuYnNwOzxzcGFuIHN0eWxlPSJjb2xvcjpsaWdodGdyYXk7Ij58PC9zcGFuPiAnOwoJfQoJaHRtbCArPSAnPC90ZD48L3RyPjwvdGFibGU+JzsKCgkvLyB3b3JkIGluZm8KCWh0bWwgKz0gJzx0YWJsZT48dHI+PHRkIGNsYXNzPSJoaWdobGlnaHRlZCI+PGgxPicrYmFzaWMrJzwvaDE+JytnZW1hdHJpYSggd29yZCApWzFdKyc8YnI+PGJyPicrZ2VtYXRyaWEoIHdvcmQgKVswXSsnPC90ZD48dGQgY2xhc3M9ImhpZ2hsaWdodGVkIj4nK3N0cm9uZ3NJbmZvKCB3b3JkICkrJzwvdGQ+PC90cj4nOwoJaHRtbCArPSAnPC90YWJsZT4nOwoJCgkvLyB3b3JkIGxvY2F0aW9ucwoJaHRtbCArPSAnPHRhYmxlPic7CglpZiAoc29tZXRoaW5nKCBpbnRlcmxpbmVhci5kYXRhW2hhc2hdICkgJiYgc29tZXRoaW5nKCBpbnRlcmxpbmVhci5kYXRhW2hhc2hdW2Jhc2ljXSApKSB7CgkJZm9yICh2YXIgW2NvZGUsIGNvZGVPYmpdIG9mIE9iamVjdC5lbnRyaWVzKGludGVybGluZWFyLmRhdGFbaGFzaF1bYmFzaWNdKSkgewoJCQlpZiAoY29kZT09JycpIGNvZGUgPSBtaXNzaW5nUGxhY2Vob2xkZXI7CgkJCWh0bWwgKz0gJzx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZTowLjdlbTtjb2xvcjpncmF5O3ZlcnRpY2FsLWFsaWduOnRvcDtib3JkZXItcmlnaHQ6c29saWQgMXB4IGxpZ2h0Z3JheTsiIHJvd3NwYW49JytPYmplY3QuZW50cmllcyhjb2RlT2JqKS5sZW5ndGgrJz4nK2NvZGUrJzwvdGQ+JzsKCQkJZm9yIChjb25zdCBbYm9vaywgYm9va09ial0gb2YgT2JqZWN0LmVudHJpZXMoY29kZU9iaikpIHsKCQkJCWh0bWwgKz0gJzx0ZD4nK25iTnVtYmVyKGNvZGVUb0xhbmcoYm9vaykpKyc8L3RkPjx0ZD4nOwoJCQkJbGV0IGRlbGltID0gJyc7CgkJCQlmb3IgKGNvbnN0IFtjaGFwLCBjaGFwT2JqXSBvZiBPYmplY3QuZW50cmllcyhib29rT2JqKSkgewoJCQkJCWZvciAoY29uc3QgdmVyc2Ugb2YgT2JqZWN0LnZhbHVlcyhjaGFwT2JqKSkgewoJCQkJCQlsZXQgdGV4dCA9IHZlcnNlVGV4dCggaW50ZXJsaW5lYXIudGV4dCwgYm9vaywgY2hhcCwgdmVyc2UgKTsKCQkJCQkJaHRtbCArPSBkZWxpbSt2ZXJzZUxpbmsoIGJvb2ssIGNoYXAsIHZlcnNlLCBjaGFwKyc6Jyt2ZXJzZSApOwoJCQkJCQlkZWxpbSA9ICcmbmJzcDsgJzsKCQkJCQl9CgkJCQl9CgkJCQlodG1sICs9ICc8L3RkPjwvdHI+JzsKCQkJfQoJCX0KCX0KCWh0bWwgKz0gJzwvdGFibGU+JzsKCWh0bWwgKz0gJzx0YWJsZT4nOwoJLy8gc3ViLXdvcmQgaW5mbwoJZm9yIChsZXQgc3ViIG9mIHN1YnN0cmluZ1NldCggYmFzaWMgKSkgewoJCWxldCBzdWJIYXNoID0gd29yZEhhc2goIHN1YiApOwoJCWlmIChzb21ldGhpbmcoIGludGVybGluZWFyLmRhdGFbc3ViSGFzaF0gKSAmJiBzb21ldGhpbmcoIGludGVybGluZWFyLmRhdGFbc3ViSGFzaF1bc3ViXSApKSB7CgkJCWh0bWwgKz0gIjx0cj48dGQ+Iit3b3JkTGluayggc3ViICkrJzxicj4nK2dlbWF0cmlhKCBzdWIgKVswXSsiPC90ZD48dGQ+IitzdHJvbmdzSW5mbyggc3ViICkrIjwvdGQ+PC90cj4iOwoJCX0KCX0KCWh0bWwgKz0gJzwvdGFibGU+JzsKCQoJcmV0dXJuIGh0bWw7Cn0KCmZ1bmN0aW9uIHZlcnNlSW5mbyAoIGJvb2ssIGNoYXAsIHZlcnNlICkgewoJLy9jb25zb2xlLmxvZyggJ3ZlcnNlSW5mbzogJytib29rKycsJytjaGFwKycsJyt2ZXJzZSApOwoKCS8vIHZlcnNlIGhpc3RvcnkKCXZhciBodG1sID0gJzx0YWJsZT4nOwoJaHRtbCArPSAnPHRyPjx0ZCBjbGFzcz0idG9wLXRkIj4nK3ZlcnNlRndkQmFjaygpKyc8L3RkPjx0ZCBjbGFzcz0idG9wLXRkIj4nOwoJdmFyIGRlbGltID0gJyc7Cglmb3IgKGNvbnN0IFtrZXksIHZlcnNlT2JqXSBvZiBPYmplY3QuZW50cmllcyh2ZXJzZUhpc3RvcnkpKSB7CgkJaHRtbCArPSBkZWxpbSt2ZXJzZUxpbmsoIHZlcnNlT2JqLmJvb2ssIHZlcnNlT2JqLmNoYXAsIHZlcnNlT2JqLnZlcnNlICk7CgkJZGVsaW0gPSAnJm5ic3A7PHNwYW4gc3R5bGU9ImNvbG9yOmxpZ2h0Z3JheTsiPnw8L3NwYW4+ICc7Cgl9CglodG1sICs9ICc8L3RkPjwvdHI+JzsKCWh0bWwgKz0gJzwvdGFibGU+JzsKCQoJLy8gdHJhbnNsYXRpb25z77+8CglodG1sICs9ICc8dGFibGU+JzsKCXZhciBsYW5nID0gaW50ZXJsaW5lYXIudHJhbnNsYXRpb25zW2xhbmd1YWdlXTsKCWxldCBkYXRhID0gdmVyc2VEYXRhKCBsYW5nLCBib29rLCBjaGFwLCB2ZXJzZSApOwoJaWYgKHNvbWV0aGluZyhkYXRhLnByZXZWZXJzZS5ib29rKSkgaHRtbCArPSAnPHRyPjx0ZCBjbGFzcz0iaGlnaGxpZ2h0ZWQiPjxjZW50ZXI+Jyt2ZXJzZUxpbmsoZGF0YS5wcmV2VmVyc2UuYm9vaywgZGF0YS5wcmV2VmVyc2UuY2hhcCwgZGF0YS5wcmV2VmVyc2UudmVyc2UsIHVwQXJyb3cpKyc8L2NlbnRlcj48L3RkPjx0ZCBjbGFzcz0iaGlnaGxpZ2h0ZWQiIHN0eWxlPSJjb2xvcjpncmF5OyI+JytkYXRhLnByZXZWZXJzZS5jaGFwKyc6JytkYXRhLnByZXZWZXJzZS52ZXJzZSsnPC90ZD48dGQgY2xhc3M9ImhpZ2hsaWdodGVkIiBzdHlsZT0iY29sb3I6Z3JheTsiPicrdmVyc2VUZXh0KCBsYW5nLCBkYXRhLnByZXZWZXJzZS5ib29rLCBkYXRhLnByZXZWZXJzZS5jaGFwLCBkYXRhLnByZXZWZXJzZS52ZXJzZSApKyc8L3RkPjwvdHI+JzsKCWh0bWwgKz0gJzx0cj48dGQgY2xhc3M9ImhpZ2hsaWdodGVkIj4nK25iTnVtYmVyKGNvZGVUb0xhbmcoYm9vaykpKyc8L3RkPjx0ZCBjbGFzcz0iaGlnaGxpZ2h0ZWQiPicrY2hhcCsnOicrdmVyc2UrJzwvdGQ+PHRkIGNsYXNzPSJoaWdobGlnaHRlZCIgc3R5bGU9IiI+Jyt2ZXJzZVRleHQoIGxhbmcsIGJvb2ssIGNoYXAsIHZlcnNlICkrJzwvdGQ+PC90cj4nOwoJaWYgKHNvbWV0aGluZyhkYXRhLm5leHRWZXJzZS5ib29rKSkgaHRtbCArPSAnPHRyPjx0ZCBjbGFzcz0iaGlnaGxpZ2h0ZWQiPjxjZW50ZXI+Jyt2ZXJzZUxpbmsoZGF0YS5uZXh0VmVyc2UuYm9vaywgZGF0YS5uZXh0VmVyc2UuY2hhcCwgZGF0YS5uZXh0VmVyc2UudmVyc2UsIGRvd25BcnJvdykrJzwvY2VudGVyPjwvdGQ+PHRkIGNsYXNzPSJoaWdobGlnaHRlZCIgc3R5bGU9ImNvbG9yOmdyYXk7Ij4nK2RhdGEubmV4dFZlcnNlLmNoYXArJzonK2RhdGEubmV4dFZlcnNlLnZlcnNlKyc8L3RkPjx0ZCBjbGFzcz0iaGlnaGxpZ2h0ZWQiIHN0eWxlPSJjb2xvcjpncmF5OyI+Jyt2ZXJzZVRleHQoIGxhbmcsIGRhdGEubmV4dFZlcnNlLmJvb2ssIGRhdGEubmV4dFZlcnNlLmNoYXAsIGRhdGEubmV4dFZlcnNlLnZlcnNlICkrJzwvdGQ+PC90cj4nOwoJaHRtbCArPSAnPC90YWJsZT4nOwoJCgkvLyBvcmlnaW5hbCB0ZXh0Cgl2YXIgdGV4dCA9IHZlcnNlVGV4dCggaW50ZXJsaW5lYXIudGV4dCwgYm9vaywgY2hhcCwgdmVyc2UgKTsKCWlmIChzb21ldGhpbmcodGV4dCkpIHsgLy8gWmVjaCAxOjE4LTIxIHdlcmUgYXQgYmVnaW5uaW5nIG9mIGNoYXAgMiBpbiAnaGJvJy4gIFRoaXMgZW5zdXJlcyBpdCdzIGNsZWFyIGlmIHNvbWV0aGluZyBpcyBtaXNzaW5nIQoJCWh0bWwgKz0gJzx0YWJsZT4nOwoJCWh0bWwgKz0gJzx0cj48dGQgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO3BhZGRpbmctdG9wOjI0cHg7cGFkZGluZy1ib3R0b206MjRweDsiPic7CgkJdmFyIHZlcnNlQXJyYXkgPSB0ZXh0LnNwbGl0KC9ccysvKTsKCQlmb3IgKGxldCB3b3JkIG9mIHZlcnNlQXJyYXkpIHsKCQkJaHRtbCArPSAnICcrd29yZExpbmsoIHdvcmQgKTsKCQl9CgkJaHRtbCArPSAnPC90ZD48L3RyPic7CgkJaHRtbCArPSAnPC90YWJsZT4nOwoJCQoJCS8vIGVhY2ggd29yZCB3aXRoIFN0cm9uZ3MgaW5mbwoJCWh0bWwgKz0gdmVyc2VBbmFseXNpcyggdmVyc2VBcnJheSwgYm9vaywgY2hhcCwgdmVyc2UgKTsKCX0gZWxzZSB7CgkJaHRtbCArPSBtaXNzaW5nUGxhY2Vob2xkZXI7Cgl9CglyZXR1cm4gaHRtbDsKfQoKCgovLyBHcmVlayBhbmQgSGVicmV3IGdlbWF0cmlhCgpmdW5jdGlvbiBnZW1hdHJpYSAoIHdvcmQgKSB7CgliYXNpYyA9IGJhc2ljV29yZCggd29yZCApOwoJdmFyIHZhbHVlID0gMDsKCXZhciBhbHR2YWwgPSAwOwoJdmFyIGFsdHRpdGxlID0gJyc7Cgl2YXIgcGFzcyA9IDA7Cgl2YXIgdGl0bGUgPSAnJzsKCXZhciBsaXN0ID0gJyc7Cgl2YXIgZGVsaW0gPSAnJzsKCXZhciBsaXN0ZGVsaW0gPSAnJzsKCQoJLy8gb3ZlcmFsbAoJZm9yIChsZXQgaT0wOyBpPGJhc2ljLmxlbmd0aDsgaSsrKSB7CgkJLy9jb25zb2xlLmxvZyggJ3Bhc3M6ICcraSsnLCBjaGFyOiAnK2Jhc2ljW2ldICk7CgkKCQkvLyBHcmVlawoJCWlmICgnzpHOsScuaW5kZXhPZiggYmFzaWNbaV0gKSA+IC0xKSBwYXNzICs9IDE7CgkJaWYgKCdCzrInLmluZGV4T2YoIGJhc2ljW2ldICkgPiAtMSkgcGFzcyArPSAyOwoJCWlmICgnzpPOsycuaW5kZXhPZiggYmFzaWNbaV0gKSA+IC0xKSBwYXNzICs9IDM7CgkJaWYgKCfOlM60Jy5pbmRleE9mKCBiYXNpY1tpXSApID4gLTEpIHBhc3MgKz0gNDsKCQlpZiAoJ86VzrUnLmluZGV4T2YoIGJhc2ljW2ldICkgPiAtMSkgcGFzcyArPSA1OwoJCWlmICgnWs62Jy5pbmRleE9mKCBiYXNpY1tpXSApID4gLTEpIHBhc3MgKz0gNzsKCQlpZiAoJ0jOtycuaW5kZXhPZiggYmFzaWNbaV0gKSA+IC0xKSBwYXNzICs9IDg7CgkJaWYgKCfOmM64Jy5pbmRleE9mKCBiYXNpY1tpXSApID4gLTEpIHBhc3MgKz0gOTsKCQlpZiAoJ86ZzrknLmluZGV4T2YoIGJhc2ljW2ldICkgPiAtMSkgcGFzcyArPSAxMDsKCQlpZiAoJ0vOuicuaW5kZXhPZiggYmFzaWNbaV0gKSA+IC0xKSBwYXNzICs9IDIwOwoJCWlmICgnzpvOuycuaW5kZXhPZiggYmFzaWNbaV0gKSA+IC0xKSBwYXNzICs9IDMwOwoJCWlmICgnTc68Jy5pbmRleE9mKCBiYXNpY1tpXSApID4gLTEpIHBhc3MgKz0gNDA7CgkJaWYgKCdOzr0nLmluZGV4T2YoIGJhc2ljW2ldICkgPiAtMSkgcGFzcyArPSA1MDsKCQlpZiAoJ86ezr4nLmluZGV4T2YoIGJhc2ljW2ldICkgPiAtMSkgcGFzcyArPSA2MDsKCQlpZiAoJ0/OvycuaW5kZXhPZiggYmFzaWNbaV0gKSA+IC0xKSBwYXNzICs9IDcwOwoJCWlmICgnUM+AJy5pbmRleE9mKCBiYXNpY1tpXSApID4gLTEpIHBhc3MgKz0gODA7CgkJaWYgKCfPn8+eJy5pbmRleE9mKCBiYXNpY1tpXSApID4gLTEpIHBhc3MgKz0gOTA7CgkJaWYgKCfOoc+BJy5pbmRleE9mKCBiYXNpY1tpXSApID4gLTEpIHBhc3MgKz0gMTAwOwoJCWlmICgnzqPPgycuaW5kZXhPZiggYmFzaWNbaV0gKSA+IC0xKSBwYXNzICs9IDIwMDsKCQlpZiAoJ1TPhCcuaW5kZXhPZiggYmFzaWNbaV0gKSA+IC0xKSBwYXNzICs9IDMwMDsKCQlpZiAoJ86lz4UnLmluZGV4T2YoIGJhc2ljW2ldICkgPiAtMSkgcGFzcyArPSA0MDA7CgkJaWYgKCfOps+GJy5pbmRleE9mKCBiYXNpY1tpXSApID4gLTEpIHBhc3MgKz0gNTAwOwoJCWlmICgnzqfPhycuaW5kZXhPZiggYmFzaWNbaV0gKSA+IC0xKSBwYXNzICs9IDYwMDsKCQlpZiAoJ86oz4gnLmluZGV4T2YoIGJhc2ljW2ldICkgPiAtMSkgcGFzcyArPSA3MDA7CgkJaWYgKCfOqc+JJy5pbmRleE9mKCBiYXNpY1tpXSApID4gLTEpIHBhc3MgKz0gODAwOwoJCWlmICgnz4InID09IGJhc2ljW2ldKSBwYXNzICs9IDIwMDsgLy8gZmluYWwgc2lnbWEKCQlpZiAoJ8+gJyA9PSBiYXNpY1tpXSkgcGFzcyArPSA5MDA7CgkJLy8gSGVicmV3CgkJaWYgKCfXkCcgPT0gYmFzaWNbaV0pIHBhc3MgKz0gMTsgLy8gb3IgMTAwMCAoYWx0dmFsKTsKCQlpZiAoJ9eRJyA9PSBiYXNpY1tpXSkgcGFzcyArPSAyOwoJCWlmICgn15InID09IGJhc2ljW2ldKSBwYXNzICs9IDM7CgkJaWYgKCfXkycgPT0gYmFzaWNbaV0pIHBhc3MgKz0gNDsKCQlpZiAoJ9eUJyA9PSBiYXNpY1tpXSkgcGFzcyArPSA1OwoJCWlmICgn15UnID09IGJhc2ljW2ldKSBwYXNzICs9IDY7CgkJaWYgKCfXlicgPT0gYmFzaWNbaV0pIHBhc3MgKz0gNzsKCQlpZiAoJ9eXJyA9PSBiYXNpY1tpXSkgcGFzcyArPSA4OwoJCWlmICgn15gnID09IGJhc2ljW2ldKSBwYXNzICs9IDk7CgkJaWYgKCfXmScgPT0gYmFzaWNbaV0pIHBhc3MgKz0gMTA7CgkJaWYgKCfXmycgPT0gYmFzaWNbaV0pIHBhc3MgKz0gMjA7CgkJaWYgKCfXmicgPT0gYmFzaWNbaV0pIHtpZiAoaTxiYXNpYy5sZW5ndGgtMSkgcGFzcys9MjA7IGVsc2UgcGFzcys9NTAwO30KCQlpZiAoJ9ecJyA9PSBiYXNpY1tpXSkgcGFzcyArPSAzMDsKCQlpZiAoJ9edJyA9PSBiYXNpY1tpXSkgcGFzcyArPSA0MDsKCQlpZiAoJ9eeJyA9PSBiYXNpY1tpXSkge2lmIChpPGJhc2ljLmxlbmd0aC0xKSBwYXNzKz00MDsgZWxzZSBwYXNzKz02MDA7fQoJCWlmICgn16AnID09IGJhc2ljW2ldKSBwYXNzICs9IDUwOwoJCWlmICgn158nID09IGJhc2ljW2ldKSB7aWYgKGk8YmFzaWMubGVuZ3RoLTEpIHBhc3MrPTUwOyBlbHNlIHBhc3MrPTcwMDt9CgkJaWYgKCfXoScgPT0gYmFzaWNbaV0pIHBhc3MgKz0gNjA7CgkJaWYgKCfXoicgPT0gYmFzaWNbaV0pIHBhc3MgKz0gNzA7CgkJaWYgKCfXpCcgPT0gYmFzaWNbaV0pIHBhc3MgKz0gODA7CgkJaWYgKCfXoycgPT0gYmFzaWNbaV0pIHtpZiAoaTxiYXNpYy5sZW5ndGgtMSkgcGFzcys9ODA7IGVsc2UgcGFzcys9ODAwO30KCQlpZiAoJ9emJyA9PSBiYXNpY1tpXSkgcGFzcyArPSA5MDsKCQlpZiAoJ9elJyA9PSBiYXNpY1tpXSkge2lmIChpPGJhc2ljLmxlbmd0aC0xKSBwYXNzKz05MDsgZWxzZSBwYXNzKz05MDA7fQoJCWlmICgn16cnID09IGJhc2ljW2ldKSBwYXNzICs9IDEwMDsKCQlpZiAoJ9eoJyA9PSBiYXNpY1tpXSkgcGFzcyArPSAyMDA7CgkJaWYgKCfXqScgPT0gYmFzaWNbaV0pIHBhc3MgKz0gMzAwOwoJCWlmICgn16onID09IGJhc2ljW2ldKSBwYXNzICs9IDQwMDsKCQkKCQl2YWx1ZSArPSBwYXNzOwoJCWlmICgn15AnID09IGJhc2ljW2ldKSB7CgkJCWFsdHZhbCArPSAxMDAwOwoJCQlhbHR0aXRsZSArPSBkZWxpbStiYXNpY1tpXSsnOicrMTAwMDsKCQl9IGVsc2UgewoJCQlhbHR2YWwgKz0gcGFzczsKCQkJYWx0dGl0bGUgKz0gZGVsaW0rYmFzaWNbaV0rJzonK3Bhc3M7CgkJfQoJCQoJCXRpdGxlICs9IGRlbGltK2Jhc2ljW2ldKyc6JytwYXNzOwoJCWxpc3QgKz0gbGlzdGRlbGltK2Jhc2ljW2ldKyc6JysoJ9eQJyA9PSBiYXNpY1tpXSA/ICcxfHwxMDAwJyA6IHBhc3MpOwoKCQlkZWxpbSA9ICcgJzsKCQlsaXN0ZGVsaW0gPSAnJm5ic3A7Jm5ic3A7ICc7CgoJCXBhc3MgPSAwOwoJfQoKCXJldHVybiBbICc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjAuN2VtO2NvbG9yOmdyYXkiIHRpdGxlPSInK3RpdGxlKyciPicrdmFsdWUrJzwvc3Bhbj4nKyh2YWx1ZT09YWx0dmFsID8gJycgOiAnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTowLjdlbTtjb2xvcjpncmF5IiB0aXRsZT0iJythbHR0aXRsZSsnIj4sJm5ic3A7JythbHR2YWwrJzwvc3Bhbj4nKSwgJzxzcGFuIHN0eWxlPSJmb250LXNpemU6MC43ZW07Y29sb3I6Z3JheSI+JytsaXN0Kyc8L3NwYW4+JyBdOwp9CgpmdW5jdGlvbiBhbHBoYVdvcmQgKCB3b3JkICkgewoJdmFyIGFscGhhID0gJyc7Cgl3b3JkTG93ZXIgPSB3b3JkLnRvTG93ZXJDYXNlKCk7Cglmb3IgKGxldCBpID0gMDsgaSA8IHdvcmQubGVuZ3RoOyBpKyspIHsKCQlpZiAoImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6Ii5pbmRleE9mKHdvcmRMb3dlcltpXSkgPiAtMSkgYWxwaGEgKz0gd29yZFtpXTsKCX0KCXJldHVybiBhbHBoYTsKfQoKZnVuY3Rpb24gYWxwaGFUZXh0ICggdGV4dCApIHsKCXZhciB0ZXh0QXJyYXlSYXcgPSB0ZXh0LnNwbGl0KC9bXHNcKFwpLV0rLyk7Cgl2YXIgdGV4dEFycmF5ID0gW107Cglmb3IgKHdvcmQgb2YgT2JqZWN0LnZhbHVlcyh0ZXh0QXJyYXlSYXcpKSB7CgkJdGV4dEFycmF5LnB1c2goIGFscGhhV29yZCh3b3JkKSApOwoJfQoJcmV0dXJuIHRleHRBcnJheTsKfQoKZnVuY3Rpb24gb3ZlcmxhcCAoIHZlcnNlLCBzdHJvbmdzTGlzdCApIHsKCS8vY29uc29sZS5sb2coIHZlcnNlICk7Cgl2YXIgdmVyc2VBcnJheSA9IGFscGhhVGV4dCh2ZXJzZSk7CgkvL2NvbnNvbGUubG9nKCB2ZXJzZUFycmF5ICk7CgkvL2NvbnNvbGUubG9nKCBzdHJvbmdzTGlzdCApOwoJdmFyIG92ZXJsYXBTZXQgPSBuZXcgU2V0KCk7Cglmb3IgKGxldCB2ZXJzZVdvcmQgb2YgT2JqZWN0LnZhbHVlcyh2ZXJzZUFycmF5KSkgewoJCWZvciAobGV0IHN0cm9uZ3NXb3JkIG9mIE9iamVjdC52YWx1ZXMoc3Ryb25nc0xpc3QpKSB7CgkJCS8vY29uc29sZS5sb2coICJjb21wYXJpbmc6ICIrc3Ryb25nc1dvcmQrIiA8LT4gIit2ZXJzZVdvcmQgKTsKCQkJaWYgKHZlcnNlV29yZD09JycpIGNvbnRpbnVlOwoJCQlsZXQgc3Ryb25nc0xvd2VyID0gc3Ryb25nc1dvcmQudG9Mb3dlckNhc2UoKTsKCQkJbGV0IHZlcnNlTG93ZXIgPSB2ZXJzZVdvcmQudG9Mb3dlckNhc2UoKTsKCQkJaWYgKCh2ZXJzZUxvd2VyLmxlbmd0aD4yICYmIHN0cm9uZ3NMb3dlci5pbmRleE9mKHZlcnNlTG93ZXIpPT0wKSB8fCAoc3Ryb25nc0xvd2VyLmxlbmd0aD4yICYmIHZlcnNlTG93ZXIuaW5kZXhPZihzdHJvbmdzTG93ZXIpPT0wKSkgewoJCQkJaWYgKHN0cm9uZ3NMb3dlciA9PSB2ZXJzZUxvd2VyKSBvdmVybGFwU2V0LmFkZCggdmVyc2VXb3JkICk7CgkJCQllbHNlIG92ZXJsYXBTZXQuYWRkKCBzdHJvbmdzV29yZCApOwoJCQl9IGVsc2UgewoJCQkJaWYgKHN0cm9uZ3NMb3dlciA9PSB2ZXJzZUxvd2VyKSBvdmVybGFwU2V0LmFkZCggdmVyc2VXb3JkICk7CgkJCX0KCQl9Cgl9CgkvL2NvbnNvbGUubG9nKCBvdmVybGFwU2V0ICk7Cgl2YXIgb3ZlcmxhcFRleHQgPSAnJzsKCXZhciBkZWxpbSA9ICcnOwoJZm9yIChsZXQgd29yZCBvZiBvdmVybGFwU2V0KSB7CgkJb3ZlcmxhcFRleHQgKz0gZGVsaW0rd29yZDsKCQlkZWxpbSA9ICcsICc7Cgl9CglyZXR1cm4gb3ZlcmxhcFRleHQ7Cn0KCi8vIGxhbmd1YWdlcwoKZnVuY3Rpb24gbGFuZ1RvQ29kZSAoIGV4cHJlc3Npb24gKSB7CgkvL2NvbnNvbGUubG9nKCAnbGFuZ1RvQ29kZTogJytleHByZXNzaW9uICk7CglpZiAoZXhwcmVzc2lvbj09JycpIHJldHVybiBleHByZXNzaW9uOwoJaWYgKHNvbWV0aGluZyhleHByZXNzaW9uKSAmJiBzb21ldGhpbmcoYWxpYXNlcy5sYW5nVG9Db2RlW2xhbmd1YWdlXSkpIHsKCQlmb3IgKGNvbnN0IFthbGlhcywgY29kZV0gb2YgT2JqZWN0LmVudHJpZXMoYWxpYXNlcy5sYW5nVG9Db2RlW2xhbmd1YWdlXSkpIHsKCQkJaWYgKGFsaWFzLnRvTG93ZXJDYXNlKCkuaW5kZXhPZiggZXhwcmVzc2lvbi50b0xvd2VyQ2FzZSgpICkgPiAtMSkgewoJCQkJY29uc29sZS5sb2coIGNvZGUgKTsKCQkJCXJldHVybiBjb2RlOwoJCQl9CgkJfQoJfQoJcmV0dXJuIGV4cHJlc3Npb247Cn0KCmZ1bmN0aW9uIGNvZGVUb0xhbmcgKCBjb2RlICkgewoJLy9jb25zb2xlLmxvZyggJ2NvZGVUb0xhbmc6ICcrY29kZSApOwoJaWYgKGNvZGU9PScnKSByZXR1cm4gY29kZTsKCS8vY29uc29sZS5sb2coIGFsaWFzZXMuY29kZVRvTGFuZ1tsYW5ndWFnZV0gKTsKCWlmIChzb21ldGhpbmcoYWxpYXNlcy5jb2RlVG9MYW5nW2xhbmd1YWdlXSkgJiYgc29tZXRoaW5nKGFsaWFzZXMuY29kZVRvTGFuZ1tsYW5ndWFnZV1bY29kZV0pKSB7CgkJLy9jb25zb2xlLmxvZyggYWxpYXNlcy5jb2RlVG9MYW5nW2xhbmd1YWdlXVtjb2RlXSApOwoJCXJldHVybiBhbGlhc2VzLmNvZGVUb0xhbmdbbGFuZ3VhZ2VdW2NvZGVdOwoJfQoJcmV0dXJuIGNvZGU7Cn0KCgoKLy8gcmVmcmVzaGluZwoKdmFyIGludGVybGluZWFyID0ge307CmludGVybGluZWFyLnRyYW5zbGF0aW9ucyA9IHt9OwoKdmFyIHZlcnNlSGlzdG9yeSA9IHt9OwkKdmFyIHdvcmRIaXN0b3J5ID0ge307Cgp2YXIgc3RhdGUgPSB7Cglib29rOidHRU4nLAoJY2hhcDonMScsCgl2ZXJzZTonMScsCgl3b3JkOifXkdeo15DXqdeZ16onCn07Cgp2YXIgaGlzdG9yeTsKdmFyIGhpc3RvcnlJbmRleDsKCmZ1bmN0aW9uIGluaXRIaXN0b3J5ICgpIHsKCWhpc3RvcnkgPSBbIHN0YXRlIF07CgloaXN0b3J5SW5kZXggPSAwOwp9CgpmdW5jdGlvbiBiYWNrSGlzdG9yeSAoKSB7Cgp9CgpmdW5jdGlvbiBmb3J3YXJkSGlzdG9yeSAoKSB7Cgp9Cgpjb25zdCByaWdodEFycm93ID0gJzxzcGFuIHN0eWxlPSJmb250LXNpemU6MS41ZW07aGVpZ2h0OjQwcHg7Ij4mbmJzcDsmIzEwMDkzOyZuYnNwOzwvc3Bhbj4nOwpjb25zdCBsZWZ0QXJyb3cgPSAnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxLjVlbTtoZWlnaHQ6NDBweDsiPiZuYnNwOyYjMTAwOTI7Jm5ic3A7PC9zcGFuPic7CmNvbnN0IHVwQXJyb3cgPSAnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToyZW07aGVpZ2h0OjQwcHg7Ij4mbmJzcDsmI3gyQjA2OyZuYnNwOzwvc3Bhbj4nOwpjb25zdCBkb3duQXJyb3cgPSAnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToyZW07aGVpZ2h0OjQwcHg7Ij4mbmJzcDsmI3gyQjA3OyZuYnNwOzwvc3Bhbj4nOwoKY29uc3QgbWlzc2luZ1BsYWNlaG9sZGVyID0gJzxzcGFuIHN0eWxlPSJmb250LXNpemU6MS41ZW07Y29sb3I6Z3JheTsiIHRpdGxlPSJVbmFibGUgdG8gZmluZCBjb250ZW50Ij4qPC9zcGFuPic7CgovLyBsYW5ndWFnZSB2YXJpYWJsZXMKdmFyIGxhbmd1YWdlU3Ryb25ncyA9ICdFbmdsaXNoIEtKVic7CnZhciBsYW5ndWFnZTsKCmZ1bmN0aW9uIGNoYW5nZUxhbmd1YWdlcyAoKSB7CgkvL3ZhciBwcmV2Q29kZSA9IGxhbmdUb0NvZGUoIGdldFZhbCggImJvb2siICkgKTsKCWxhbmd1YWdlID0gZ2V0VmFsKCAibGFuZyIgKTsKCQoJY2hhbmdlQm9va1NlbGVjdCgpOwoJc2V0VmFsKCAiYm9vayIsIHN0YXRlLmJvb2sgKTsKCQoJcmVmcmVzaCgpOwp9CgpmdW5jdGlvbiBjaGFuZ2VCb29rU2VsZWN0ICgpIHsKCXZhciBib29rU2VsZWN0ID0gZ2V0SWQoICJib29rIiApOwoJYm9va1NlbGVjdC5pbm5lckhUTUwgPSAiIjsKCS8vc2V0VmFsKCAiYm9vayIsIGNvZGVUb0xhbmcoIHN0YXRlLmJvb2sgKSApOwoJZm9yIChsZXQgYm9vayBvZiBPYmplY3Qua2V5cyhpbnRlcmxpbmVhci50ZXh0KSkgewoJCWNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOwoJCW9wdGlvbi52YWx1ZSA9IGJvb2s7CgkJb3B0aW9uLnRleHQgPSBjb2RlVG9MYW5nKCBib29rICk7CgkJYm9va1NlbGVjdC5hZGQoIG9wdGlvbiApOwoJfQp9CgpmdW5jdGlvbiBnZXRRdWVyeSAoKSB7Cgl2YXIgc2VhcmNoID0gbG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKTsKCWlmIChzb21ldGhpbmcoc2VhcmNoKSkgewoJCWNvbnNvbGUubG9nKCAiU2VhcmNoOiAiK3NlYXJjaCApOwoJCXZhciBxdWVyeSA9IHNlYXJjaC5zcGxpdCggJyYnICk7CgkJZm9yIChsZXQga2V5dmFsIG9mIE9iamVjdC52YWx1ZXMocXVlcnkpKSB7CgkJCXR1cGxlID0ga2V5dmFsLnNwbGl0KCAnPScgKTsKCQkJc3RhdGVbdHVwbGVbMF1dID0gZGVjb2RlVVJJKHR1cGxlWzFdKTsKCQl9CgkJc2V0VmFsKCAiYm9vayIsIHN0YXRlLmJvb2sgKTsKCQlzZXRWYWwoICJjaGFwIiwgc3RhdGUuY2hhcCApOwoJCXNldFZhbCggInZlcnNlIiwgc3RhdGUudmVyc2UgKTsKCQlzZXRWYWwoICJ3b3JkIiwgc3RhdGUud29yZCApOwoJfQoJCn0KCmZ1bmN0aW9uIGxvYWRpbmdQcm9ncmVzcyAoIHByb2cgKSB7CglzZXRWYWwoICJsb2FkaW5nIiwgcHJvZyApOwp9CgpmdW5jdGlvbiBjaGFuZ2VCb29rICggYm9vayApIHsKCWNoYW5nZVZlcnNlKCBib29rLCAxLCAxICk7Cn0KCmZ1bmN0aW9uIGNoYW5nZVZlcnNlICggYm9vaywgY2hhcCwgdmVyc2UgKSB7CgkvL2NvbnNvbGUubG9nKCAnY2hhbmdlVmVyc2U6ICcrYm9vaysnLCcrY2hhcCsnLCcrdmVyc2UgKTsKCXN0YXRlLmJvb2sgPSBib29rOwoJc3RhdGUuY2hhcCA9IGNoYXA7CglzdGF0ZS52ZXJzZSA9IHZlcnNlOwoKCXJlZnJlc2goKTsKfQoKZnVuY3Rpb24gY2hhbmdlV29yZCAoIHdvcmQgKSB7CglzdGF0ZS53b3JkID0gYmFzaWNXb3JkKCB3b3JkICk7CgkKCXJlZnJlc2goKTsKfQoKZnVuY3Rpb24gcmVmcmVzaCAoKSB7Cgljb25zb2xlLmxvZyggInN0YXRlOiIgKTsKCWNvbnNvbGUubG9nKCBzdGF0ZSApOwoKCXNldFZhbCggImJvb2siLCBzdGF0ZS5ib29rICk7CglzZXRWYWwoICJjaGFwIiwgc3RhdGUuY2hhcCApOwoJc2V0VmFsKCAidmVyc2UiLCBzdGF0ZS52ZXJzZSApOwkJCglzZXRWYWwoICJ3b3JkIiwgc3RhdGUud29yZCApOwoKCS8vIHZlcnNlIGhpc3RvcnkKCXZlcnNlSGlzdG9yeVtzdGF0ZS5ib29rK3N0YXRlLmNoYXBdID0geyBib29rOnN0YXRlLmJvb2ssIGNoYXA6c3RhdGUuY2hhcCwgdmVyc2U6c3RhdGUudmVyc2UgfTsKCQoJLy8gd29yZCBoaXN0b3J5Cgl3b3JkSGlzdG9yeVtiYXNpY1dvcmQoc3RhdGUud29yZCldID0gbnVsbDsKCQoJLy8gcmVmcmVzaCBkaXZzCglnZXRJZCggInZlcnNlRGl2IiApLmlubmVySFRNTCA9IHZlcnNlSW5mbyggc3RhdGUuYm9vaywgc3RhdGUuY2hhcCwgc3RhdGUudmVyc2UgKTsKCWdldElkKCAid29yZERpdiIgKS5pbm5lckhUTUwgPSB3b3JkSW5mbyggc3RhdGUud29yZCApOwoJCgkvLyBwYWdlIGhpc3RvcnkKCWhpc3RvcnkucmVwbGFjZVN0YXRlKAoJCXsgYm9vazpzdGF0ZS5ib29rLCBjaGFwOnN0YXRlLmNoYXAsIHZlcnNlOnN0YXRlLnZlcnNlLCB3b3JkOnN0YXRlLndvcmQsIHZpZXc6c3RhdGUudmlldyB9LAoJCXN0YXRlLmJvb2srJyAnK3N0YXRlLmNoYXArJzonK3N0YXRlLnZlcnNlKycgKCcrc3RhdGUud29yZCsnKScsCgkJJz9ib29rPScrc3RhdGUuYm9vaysnJmNoYXA9JytzdGF0ZS5jaGFwKycmdmVyc2U9JytzdGF0ZS52ZXJzZSsnJnZpZXc9JytzdGF0ZS52aWV3Kycmd29yZD0nK3N0YXRlLndvcmQKCSk7CgkKCWlmIChzb21ldGhpbmcoc3RhdGUudmlldykgJiYgc29tZXRoaW5nKCBzdGF0ZS52aWV3ICkgJiYgc29tZXRoaW5nKGdldElkKCBzdGF0ZS52aWV3ICkpKSBnZXRJZCggc3RhdGUudmlldyApLnNjcm9sbEludG9WaWV3KCk7Cn0KCgoK"></script>

<script>
	setVal( "test-input", "hello!" );
</script>

</body>
</html>

